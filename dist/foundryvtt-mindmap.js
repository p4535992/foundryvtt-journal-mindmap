!function(e){function t(t){for(var s,r,i=t[0],l=t[1],c=t[3]||[],u=0,h=[];u<i.length;u++)r=i[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&h.push(a[r][0]),a[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);for(d&&d(t),c.forEach((function(e){if(void 0===a[e]){a[e]=null;var t=document.createElement("link");n.nc&&t.setAttribute("nonce",n.nc),t.rel="prefetch",t.as="script",t.href=o(e),document.head.appendChild(t)}}));h.length;)h.shift()()}var s={},a={index:0};function o(e){return n.p+"bundles/"+({"vendors~cise":"vendors~cise","vendors~cola":"vendors~cola","vendors~compound-drag-and-drop":"vendors~compound-drag-and-drop","vendors~cxtmenu":"vendors~cxtmenu","vendors~cytoscape~spread":"vendors~cytoscape~spread","vendors~cytoscape":"vendors~cytoscape","vendors~spread":"vendors~spread","vendors~dagre":"vendors~dagre","vendors~edgehandles":"vendors~edgehandles","vendors~fcose":"vendors~fcose","vendors~klay":"vendors~klay"}[e]||e)+".bundle.js"}function n(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.e=function(e){var t=[],s=a[e];if(0!==s)if(s)t.push(s[2]);else{var r=new Promise((function(t,o){s=a[e]=[t,o]}));t.push(s[2]=r);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.src=o(e);var d=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(c);var s=a[e];if(0!==s){if(s){var o=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+o+": "+n+")",d.name="ChunkLoadError",d.type=o,d.request=n,s[1](d)}a[e]=void 0}};var c=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},n.m=e,n.c=s,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="modules/foundryvtt-mindmap/",n.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],i=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var d=i,c=n(n.s="./dist/foundryvtt-mindmap.js");t([[],{},0,["vendors~cytoscape~spread","vendors~cytoscape","vendors~spread","vendors~cise","vendors~cola","vendors~compound-drag-and-drop","vendors~cxtmenu","vendors~dagre","vendors~edgehandles","vendors~fcose","vendors~klay"]])}({"./dist/foundryvtt-mindmap.js":
/*!************************************!*\
  !*** ./dist/foundryvtt-mindmap.js ***!
  \************************************/
/*! exports provided: debugEnabled, debug, log, warn, error, timelog, i18n, i18nFormat, setDebugLevel */function(e,t,s){"use strict";s.r(t),s.d(t,"debugEnabled",(function(){return i})),s.d(t,"debug",(function(){return l})),s.d(t,"log",(function(){return d})),s.d(t,"warn",(function(){return c})),s.d(t,"error",(function(){return u})),s.d(t,"timelog",(function(){return h})),s.d(t,"i18n",(function(){return p})),s.d(t,"i18nFormat",(function(){return g})),s.d(t,"setDebugLevel",(function(){return m}));var a=s(/*! ./module/settings.js */"./dist/module/settings.js"),o=s(/*! ./module/preloadTemplates.js */"./dist/module/preloadTemplates.js"),n=s(/*! ./module/Hooks.js */"./dist/module/Hooks.js"),r=s(/*! ./module/graph-journal-sheet.js */"./dist/module/graph-journal-sheet.js");let i=0,l=(...e)=>{i>1&&console.log(`DEBUG:${a.FOUNDRYVTT_MINDMAP_MODULE_NAME} | `,...e)},d=(...e)=>console.log(a.FOUNDRYVTT_MINDMAP_MODULE_NAME+" | ",...e),c=(...e)=>{i>0&&console.warn(a.FOUNDRYVTT_MINDMAP_MODULE_NAME+" | ",...e)},u=(...e)=>console.error(a.FOUNDRYVTT_MINDMAP_MODULE_NAME+" | ",...e),h=(...e)=>c(a.FOUNDRYVTT_MINDMAP_MODULE_NAME+" | ",Date.now(),...e),p=e=>game.i18n.localize(e),g=(e,t={})=>game.i18n.format(e,t),m=e=>{i={none:0,warn:1,debug:2,all:3}[e]||0,i>=3&&(CONFIG.debug.hooks=!0)};Hooks.once("init",async()=>{console.log(`${a.FOUNDRYVTT_MINDMAP_MODULE_NAME} | Initializing ${a.FOUNDRYVTT_MINDMAP_MODULE_NAME}`),Object(n.initHooks)(),Object(a.registerSettings)(),await Object(o.preloadTemplates)(),CONFIG.JournalEntry.sheetClass=r.GraphJournalSheet,console.log("CustomJournals | Creating the structure to allow multiple Journal Sheets."),console.log(a.FOUNDRYVTT_MINDMAP_MODULE_NAME+" | Registering the module's sheets."),EntitySheetConfig.registerSheet(JournalEntry,"journals",r.GraphJournalSheet,{label:"GraphJournalSheet",types:[CONST.BASE_ENTITY_TYPE],makeDefault:!1})}),Hooks.once("setup",(function(){Object(a.registerSettings)()})),Hooks.once("ready",(function(){Object(n.readyHooks)()}))},"./dist/module/Hooks.js":
/*!******************************!*\
  !*** ./dist/module/Hooks.js ***!
  \******************************/
/*! exports provided: readyHooks, initHooks */function(e,t,s){"use strict";s.r(t),s.d(t,"readyHooks",(function(){return o})),s.d(t,"initHooks",(function(){return n}));var a=s(/*! ../foundryvtt-mindmap.js */"./dist/foundryvtt-mindmap.js");let o=async()=>{},n=()=>{Object(a.warn)("Init Hooks processing")}},"./dist/module/graph-journal-sheet.js":
/*!********************************************!*\
  !*** ./dist/module/graph-journal-sheet.js ***!
  \********************************************/
/*! exports provided: GraphJournalSheet */function(e,t,s){"use strict";s.r(t),s.d(t,"GraphJournalSheet",(function(){return r}));var a=s(/*! ../foundryvtt-mindmap.js */"./dist/foundryvtt-mindmap.js"),o=s(/*! ./graph.js */"./dist/module/graph.js"),n=s(/*! ./settings.js */"./dist/module/settings.js");class r extends JournalSheet{get template(){return"graph"===this._sheetMode.toString()?`/modules/${n.FOUNDRYVTT_MINDMAP_MODULE_NAME}/templates/graph-journal-sheet.html`:super.template}static get defaultOptions(){const e=super.defaultOptions;return e.baseApplication="JournalSheet",e.classes.push("graph-journal"),e}_getHeaderButtons(){const e=this.object.owner,t=this.object.hasPerm(game.user,"LIMITED"),s=!!this.object.getFlag(n.FOUNDRYVTT_MINDMAP_MODULE_NAME,"data"),a=this.object.data.img&&this.object.data.content;s&&!a&&(this.object.data.img?this.object.data.content="!!||!!":this.object.data.img="!!||!!");let o=super._getHeaderButtons();if((e||t&&s)&&o.splice(1,0,{label:"MindMap",class:"entry-graph",icon:"fas fa-project-diagram",onclick:e=>this._onSwapMode(e,"graph")}),s&&!a)if("!!||!!"===this.object.data.img){this.object.data.img="";const e=o.findIndex(e=>"Image"===e.label);o.splice(e,1)}else{this.object.data.content="";const e=o.findIndex(e=>"Text"===e.label);o.splice(e,1)}return o}_inferDefaultMode(){const e=!!this.object.data.img,t=!!this.object.getFlag(n.FOUNDRYVTT_MINDMAP_MODULE_NAME,"data.elements"),s=this.object.limited?null:this.object.data.content?"text":t?"graph":"text";return e?"image":s}activateListeners(e){if(super.activateListeners(e),"graph"!==this._sheetMode.toString())return;const t=e[0].querySelector(".graph");this._graph&&this._graph.destroy(),this._graph=new o.Graph(t,this.object);const s=e[0].querySelector(".graph-settings-menu");s.addEventListener("click",e=>(e.preventDefault(),e.stopPropagation(),e.currentTarget.closest(".graph-settings").classList.remove("open"),e.currentTarget.closest(".graph-settings").querySelector(".graph-layout-chooser").classList.remove("open"),!1)),s.addEventListener("mousedown",e=>(e.preventDefault(),e.stopPropagation(),!1)),s.addEventListener("mouseup",e=>(e.preventDefault(),e.stopPropagation(),!1)),e[0].querySelector(".graph-settings-btn").addEventListener("click",e=>(e.preventDefault(),e.stopPropagation(),e.currentTarget.closest(".graph-settings").classList.toggle("open"),!1)),s.querySelector(".graph-fit-btn").addEventListener("click",e=>this._graph.fit()),s.querySelector(".graph-clear-btn").addEventListener("click",e=>this._graph.removeSelected()),s.querySelector(".graph-layout-btn").addEventListener("click",e=>(e.preventDefault(),e.stopPropagation(),e.currentTarget.parentNode.querySelector(".graph-layout-chooser").classList.toggle("show"),!1)),s.querySelector(".graph-layout-chooser").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this._graph.layout=e.target.name}),e[0].addEventListener("click",e=>e.currentTarget.querySelector(".graph-settings").classList.remove("open"))}getData(){const e=super.getData();return e.layouts=o.Graph.layouts,e}render(e=!1,t={}){if(Object(a.debug)("rendering sheet",t),this.rendered&&(!t.sheetMode||"graph"===t.sheetMode)&&"graph"===this._sheetMode.toString()){const e=getProperty(t,"data.flags."+n.FOUNDRYVTT_MINDMAP_MODULE_NAME+".data");return e&&this._graph.update(e),this}return this._graph&&this._graph._cy&&this._graph._cy.destroy(),super.render(e,t)}async _render(...e){await super._render(...e)}_injectHTML(e,t){$("body").append(e),this._element=e,e.hide().fadeIn(200,e=>{this._graph&&this._graph.init()})}setPosition(...e){const[t,s,a,o,n]=e,r=super.setPosition({left:t,top:s,width:a,height:o,scale:n});return this._graph&&this._graph.update(),r}}},"./dist/module/graph.js":
/*!******************************!*\
  !*** ./dist/module/graph.js ***!
  \******************************/
/*! exports provided: Graph */function(e,t,s){"use strict";s.r(t),s.d(t,"Graph",(function(){return i}));var a=s(/*! ../foundryvtt-mindmap.js */"./dist/foundryvtt-mindmap.js"),o=s(/*! ./settings.js */"./dist/module/settings.js");let n;let r=!1;class i{constructor(e,t,s={}){this._style=[...this.defaultStyle,...s.style||[]],this._layout={...this.defaultLayout,...s.layout||{}},this._journal=t,this._container=e,this._selectedNode=null,this._dragTime=null}async init(){n||await async function(){n=await Promise.all(/*! import() | cytoscape */[s.e("vendors~cytoscape~spread"),s.e("vendors~cytoscape")]).then(s.t.bind(null,/*! cytoscape */"./node_modules/cytoscape/dist/cytoscape.cjs.js",7))}(),r||await async function(){const e=(await s.e(/*! import() | edgehandles */"vendors~edgehandles").then(s.t.bind(null,/*! cytoscape-edgehandles */"./node_modules/cytoscape-edgehandles/cytoscape-edgehandles.js",7))).default,t=(await s.e(/*! import() | cxtmenu */"vendors~cxtmenu").then(s.t.bind(null,/*! cytoscape-cxtmenu */"./node_modules/cytoscape-cxtmenu/cytoscape-cxtmenu.js",7))).default,a=(await s.e(/*! import() | compound-drag-and-drop */"vendors~compound-drag-and-drop").then(s.t.bind(null,/*! cytoscape-compound-drag-and-drop */"./node_modules/cytoscape-compound-drag-and-drop/cytoscape-compound-drag-and-drop.js",7))).default;n.use(a),n.use(e),n.use(t),r=!0}();const e=this._journal,t=this._container;let l=e.getFlag(o.FOUNDRYVTT_MINDMAP_MODULE_NAME,"data")||{elements:{}};if(l.elements.nodes||(l.elements=[{data:{name:"Drag Entities onto the Canvas or right click me.",type:"text"},classes:["text-node"]}]),l.layout){let e=i.layouts.find(e=>e.name===l.layout.name);this._layout={...this.defaultLayout,...e}}else this._layout=this.defaultLayout;Object(a.log)("Initializing.. ",l,this),this._cy=n.default({container:t,elements:l.elements,layout:{name:"preset"},style:this._style,boxSelectionEnabled:!0,autoungrabify:e.permission<CONST.ENTITY_PERMISSIONS.OWNER,autounselectify:e.permission<CONST.ENTITY_PERMISSIONS.OWNER}),window.cy=this._cy;if(this._cy.compoundDragAndDrop().enable(),await this.update(),this._cy.nodes().unselect(),this._cy.on("click","node",e=>this._onDblClick(e)),e.permission<CONST.ENTITY_PERMISSIONS.OWNER)return;this._eh=this._cy.edgehandles({snap:!0,stop:(e,t,s)=>{this._eh.disable()},complete:(e,t,s)=>{Object(a.log)(e,t,s,this._cy.json().elements),this.saveDataToJournal()}}),this._eh.hide(),this._eh.disable();const d=this.cxtMenuCommands;for(let e of d)this._cy.cxtmenu(e);this._cy.on("free","node",e=>{this.saveDataToJournal()}),t.addEventListener("dragover",e=>this._onDragOver(e)),t.addEventListener("dragenter",e=>this._onDragEnter(e)),t.addEventListener("drop",e=>this._onDropEntity(e))}get cxtMenuCommands(){let e=[];const t={fillColor:"RGBA(50, 50, 50, 0.75)",content:'<i class="fas fa-tag"></i><br>Modify label',contentStyle:{},select:e=>this._modifyData(e,"name","text"),enabled:!0};let s=[{fillColor:"RGBA(200, 50, 50, 0.75)",content:'<i class="fa fa-trash" aria-hidden="true"></i><br>Remove<br>Node',select:e=>this.removeElement(e),enabled:!0},{fillColor:"RGBA(50, 50, 50, 0.75)",content:"Toggle visited",select:e=>{e.toggleClass("visited"),this.saveDataToJournal()},enabled:!0},{fillColor:"RGBA(50, 50, 50, 0.75)",content:"Add<br>Edge",select:e=>{this._eh.enable(),this._eh.start(e)},enabled:!0},{fillColor:"RGBA(50, 50, 50, 0.75)",content:"Add<br>Textnode",select:async e=>{const t=await this.addNode(null,e.renderedPosition());this.addEdge(e.data().id,t.data().id,!0)},enabled:!0},t],a=[...s,{fillColor:"RGBA(50, 50, 50, 0.75)",content:'<i class="fas fa-eye"></i><br>Open Sheet',select:e=>this._showEntity(e.data().uuid),enabled:!0}];return e.push({selector:".scene",commands:[...s,{fillColor:"RGBA(50, 50, 50, 0.75)",content:'<i class="fas fa-bullseye fa-fw"></i><br>Activate',select:async e=>{(await fromUuid(e.data().uuid)).activate()},enabled:!0}]}),e.push({selector:".journal-entry",commands:[...a]}),e.push({selector:".actor",commands:[...a]}),e.push({selector:".rollable-tables",commands:[...a]}),e.push({selector:".item",commands:[...a]}),e.push({selector:".macro",commands:[...a]}),e.push({selector:".text-node",commands:[...s]}),e.push({selector:"node:compound",commands:[...s]}),e.push({selector:"edge",commands:[{fillColor:"RGBA(200, 50, 50, 0.75)",content:'<i class="fa fa-trash" aria-hidden="true"></i><br>Remove<br>Edge',select:e=>this.removeElement(e),enabled:!0},{fillColor:"RGBA(50, 50, 50, 0.75)",content:'<i class="fas fa-map-signs"></i><br>Toggle direction',contentStyle:{},select:e=>this._toggleEdgeDirection(e),enabled:!0},t,{fillColor:"RGBA(50, 50, 50, 0.75)",content:'<i class="fas fa-palette"></i><br>Change Color',contentStyle:{},select:e=>this._modifyData(e,"color","color"),enabled:!0}]}),e}get defaultStyle(){return[{selector:"node",style:{"background-fit":"cover","background-color":"#666","text-valign":"bottom","border-width":1,"border-style":"solid","border-color":"#666","border-opacity":.8,"font-family":"Signika, sans-serif","font-size":9,"text-wrap":"wrap","text-max-width":"100px",color:"#333",width:30,height:30}},{selector:"node[name]",style:{label:"data(name)"}},{selector:"node:compound",style:{"background-color":"#999","background-opacity":"0.5"}},{selector:".visited",style:{opacity:.55,"border-color":"#A00","border-width":2,"background-blacken":.3}},{selector:"edge",style:{"curve-style":"bezier",width:"2px","line-color":"#999","target-arrow-color":"#999","target-arrow-shape":"triangle-backcurve","arrow-scale":1.5,"source-endpoint":"outside-to-node-or-label","target-endpoint":"outside-to-node-or-label"}},{selector:".undirected",style:{"target-arrow-shape":"none"}},{selector:"edge[name]",style:{"font-family":"Signika, sans-serif",label:"data(name)","text-rotation":"autorotate",color:"#333","font-size":9,"text-wrap":"wrap","text-max-width":"40px","text-outline-color":"#ccc","text-outline-width":1,"text-outline-opacity":.5}},{selector:"edge[color]",style:{"line-color":"data(color)","target-arrow-color":"data(color)"}},{selector:".journal-entry",style:{"background-image":`/modules/${o.FOUNDRYVTT_MINDMAP_MODULE_NAME}/assets/open-book.png`}},{selector:".actor",style:{"background-image":`/modules/${o.FOUNDRYVTT_MINDMAP_MODULE_NAME}/assets/assets/person.png`}},{selector:".item",style:{"background-image":`/modules/${o.FOUNDRYVTT_MINDMAP_MODULE_NAME}/assets/assets/suitcase.png`}},{selector:".roll-table",style:{"background-image":`/modules/${o.FOUNDRYVTT_MINDMAP_MODULE_NAME}/assets/assets/rolling-dices.png`}},{selector:".macro",style:{"background-image":"icons/svg/dice-target.svg"}},{selector:".img",style:{"background-image":"data(img)"}},{selector:"node:selected",style:{"border-style":"dashed","border-width":"2px","border-color":"#0169d9","border-opacity":1,"background-blacken":-.3}},{selector:".text-node",style:{shape:"star",width:15,height:15,"font-size":9}}]}get defaultLayout(){return{name:"dagre",animate:!0,fit:!0,nodeDimensionsIncludeLabels:!0,animationEasing:"ease-out-sine",animationDuration:300}}static get layouts(){return[{name:"preset",label:"Manual",fit:!1},{name:"grid",label:"Grid"},{name:"circle",label:"Circle"},{name:"concentric",label:"Concentric Circles"},{name:"breadthfirst",label:"Breadthfirst (Tree like)",directed:!0},{name:"dagre",label:"Dagre"},{name:"klay",label:"Klay"},{name:"fcose",label:"fast Compound Spring Embedder",quality:"proof",randomize:!1},{name:"spread",label:"Spread"},{name:"cise",label:"Circular Spring Embedder",animate:!1},{name:"cola",label:"Cola"},{name:"random",label:"Random"}]}set layout(e){const t=i.layouts.find(t=>t.name===e);if(!t)throw new Error("Graphs | Layout not found!");this._layout={...this.defaultLayout,...t},this.saveDataToJournal()}_getClassByEntityName(e){return{JournalEntry:"journal-entry",Actor:"actor",Item:"item",Scene:"scene",RollTable:"roll-table",Macro:"macro"}[e]}async addNode(e,t,s=!1){let a;e?(a={data:{name:e.name,type:e.entity,uuid:e.uuid},classes:[this._getClassByEntityName(e.entity),"entity"]},e.data.thumb?(a.data.img=e.data.thumb,a.classes.push("img")):(e.img||e.data.img)&&(a.data.img=e.img||e.data.img,a.classes.push("img"))):a={data:{name:"New Textnode",type:"text"},classes:["text-node"]},t&&(a.renderedPosition=t);const o=this._cy.add(a);return s&&this.saveDataToJournal(),o}async addEdge(e,t,s=!1){let a={data:{source:e,target:t}};this._cy.add(a);s&&this.saveDataToJournal()}async removeElement(e){e.remove(),this.saveDataToJournal()}async _onDropEntity(e){let t,s;e.preventDefault();try{t=JSON.parse(e.dataTransfer.getData("text/plain"))}catch(e){return!1}if(!this._getClassByEntityName(t.type))return!1;try{if(t.pack)s=await fromUuid(["Compendium",t.pack,t.id].join("."));else if(t.actorId){const e=["Actor",t.actorId,"OwnedItem",t.data._id].join(".");s=await fromUuid(e),s.uuid=e,s.id=s._id,s.entity="Item"}else s=await fromUuid([t.type,t.id].join("."))}catch(e){return console.error(e),void ui.notifications.error("Unsupported entity type")}const a={x:e.offsetX,y:e.offsetY},o=this._selectedNode;let n;try{n=await this.addNode(s,a,!o)}catch(e){return console.error(e),ui.notifications.error("Only one node of that UUID is allowed."),!1}o&&this.addEdge(o.data().id,n.data().id,!0),this._selectedNode&&(this._selectedNode.unselect(),this._selectedNode=null)}async _onDragOver(e){if(e.timeStamp-this._dragTime<50)return;this._dragTime=e.timeStamp;const t=this._cy.nodes();if(0===t.length)return;let s=t[0].renderedWidth();const a=e.offsetX,o=e.offsetY;this._selectedNode&&this._selectedNode.unselect(),this._selectedNode=null,t.forEach(e=>{let t=e.renderedPosition(),n=Math.abs(t.x-a)+Math.abs(t.y-o);n<s&&(n=s,this._selectedNode=e)}),this._selectedNode&&this._selectedNode.select()}async _onDragEnter(e){this._cy.nodes().unselect()}async saveDataToJournal(){Object(a.debug)("Saving Data..."),this._cy.nodes(".eh-ghost").remove();let e=this._cy.json().elements;e.edges&&0!==e.edges.length||(e["-=edges"]=null),e.nodes&&0!==e.nodes.length||(e["-=nodes"]=null);let t={elements:e,layout:this._layout};this._cy.one("layoutstop",e=>{let t=this._cy.json().elements;t.edges&&0!==t.edges.length||(t["-=edges"]=null),t.nodes&&0!==t.nodes.length||(t["-=nodes"]=null);let s={elements:t,layout:this._layout};this._journal.setFlag(o.FOUNDRYVTT_MINDMAP_MODULE_NAME,"data",s)}),this.update(t)}_onDblClick(e){this._rightClicked=null,this._clicked&&Math.abs(this._clicked.time-e.timeStamp)<300&&this._clicked.target===e.target.data().id?(e.preventDefault(),e.stopPropagation(),e.target.data("uuid")&&this._showEntity(e.target.data().uuid),this._clicked=null):this._clicked={time:e.timeStamp,target:e.target.data().id}}async _showEntity(e){let t=await fromUuid(e);t.entity||(t=new CONFIG.Item.entityClass(t,null)),t.permission>CONST.ENTITY_PERMISSIONS.NONE&&t.sheet.render(!0)}async _toggleEdgeDirection(e){if(e.hasClass("undirected")){const t=duplicate(e.data()),s=t.source,a=t.target;t.source=a,t.target=s,e.remove(),delete t.id,this._cy.add({data:t})}else e.addClass("undirected");this.saveDataToJournal()}async update(e={}){if(this._cy){if(e.elements){const t=e.elements;this._cy.json({elements:t})}e.layout&&(this._layout={...this.defaultLayout,...e.layout}),this._cy.extension("layout",this._layout.name)||await async function(e){const t=(await{dagre:async()=>s.e(/*! import() | dagre */"vendors~dagre").then(s.t.bind(null,/*! cytoscape-dagre */"./node_modules/cytoscape-dagre/cytoscape-dagre.js",7)),klay:async()=>s.e(/*! import() | klay */"vendors~klay").then(s.t.bind(null,/*! cytoscape-klay */"./node_modules/cytoscape-klay/cytoscape-klay.js",7)),cola:async()=>s.e(/*! import() | cola */"vendors~cola").then(s.t.bind(null,/*! cytoscape-cola */"./node_modules/cytoscape-cola/cytoscape-cola.js",7)),fcose:async()=>s.e(/*! import() | fcose */"vendors~fcose").then(s.t.bind(null,/*! cytoscape-fcose */"./node_modules/cytoscape-fcose/cytoscape-fcose.js",7)),cise:async()=>s.e(/*! import() | cise */"vendors~cise").then(s.t.bind(null,/*! cytoscape-cise */"./node_modules/cytoscape-cise/cytoscape-cise.js",7)),spread:async()=>Promise.all(/*! import() | spread */[s.e("vendors~cytoscape~spread"),s.e("vendors~spread")]).then(s.t.bind(null,/*! cytoscape-spread */"./node_modules/cytoscape-spread/cytoscape-spread.js",7))}[e]()).default;n.use(t)}(this._layout.name),this._cy.layout(this._layout).run(),this._cy.resize(),this._cy.fit()}}async _modifyData(e,t,s){let a=document.createElement("input");const o=e.data(t)||"";a.value=o,a.type=s,a.style.position="absolute",a.style.left="-500px",a.style.top="-100px",a.style.width="300px";let n="color"===s?2:1;a.addEventListener("focusout",s=>{const r=a.value;r!==o&&(e.data(t,r),this.saveDataToJournal()),n--,a&&!n&&a.remove()}),a.addEventListener("input",s=>{const o=a.value;e.data(t,o)}),a.addEventListener("keyup",e=>{"Escape"!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),"Escape"===e.key&&(a.value=name),e.currentTarget.blur())}),await this._container.appendChild(a),a.focus(),a.click(),window.input=a}fit(){this._cy.fit(),this._cy.resize()}removeSelected(){this._cy.nodes(":selected").remove(),this.saveDataToJournal()}destroy(){this._cy&&this._cy.destroy()}}},"./dist/module/preloadTemplates.js":
/*!*****************************************!*\
  !*** ./dist/module/preloadTemplates.js ***!
  \*****************************************/
/*! exports provided: preloadTemplates */function(e,t,s){"use strict";s.r(t),s.d(t,"preloadTemplates",(function(){return o}));var a=s(/*! ./settings.js */"./dist/module/settings.js");const o=async function(){const e=[`/modules/${a.FOUNDRYVTT_MINDMAP_MODULE_NAME}/templates/graph-journal-sheet.html`];return loadTemplates(e)}},"./dist/module/settings.js":
/*!*********************************!*\
  !*** ./dist/module/settings.js ***!
  \*********************************/
/*! exports provided: FOUNDRYVTT_MINDMAP_MODULE_NAME, registerSettings */function(e,t,s){"use strict";s.r(t),s.d(t,"FOUNDRYVTT_MINDMAP_MODULE_NAME",(function(){return a})),s.d(t,"registerSettings",(function(){return o}));const a="foundryvtt-mindmap",o=function(){}}});
//# sourceMappingURL=foundryvtt-mindmap.js.map