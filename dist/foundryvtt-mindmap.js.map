{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./dist/foundryvtt-mindmap.js","webpack:///./dist/module/Hooks.js","webpack:///./dist/module/graph-journal-sheet.js","webpack:///./dist/module/graph.js","webpack:///./dist/module/preloadTemplates.js","webpack:///./dist/module/settings.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","prefetchChunks","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","forEach","undefined","link","document","createElement","__webpack_require__","nc","setAttribute","rel","as","href","jsonpScriptSrc","head","appendChild","shift","installedModules","p","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","charset","timeout","src","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","setTimeout","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","startupResult","s","debugEnabled","debug","args","log","warn","timelog","Date","now","i18n","game","localize","i18nFormat","format","setDebugLevel","debugText","CONFIG","hooks","Hooks","once","async","CONST","BASE_ENTITY_TYPE","EntitySheetConfig","registerSheet","JournalEntry","types","makeDefault","readyHooks","initHooks","GraphJournalSheet","JournalSheet","this","_sheetMode","toString","super","template","options","defaultOptions","baseApplication","classes","style_formats","title","items","inline","wrapper","activateEditor","isOwner","owner","atLeastLimited","hasPerm","user","hasMindMap","getFlag","hasMultipleModes","buttons","_getHeaderButtons","splice","label","class","icon","onclick","ev","_onSwapMode","idx","findIndex","hasImage","hasMindmapElements","otherwise","limited","html","activateListeners","graphContainer","querySelector","destroy","settings","addEventListener","preventDefault","stopPropagation","currentTarget","closest","classList","remove","toggle","fit","removeSelected","parentNode","layout","getData","layouts","force","rendered","udata","getProperty","update","_cy","render","_render","$","append","_element","hide","fadeIn","init","left","top","width","height","scale","ret","setPosition","cytoscape","extensionsImported","Graph","container","journal","defaultStyle","defaultLayout","initCytoscape","edgehandles","default","contextMenus","compoundDragAndDrop","use","importExtensions","json","elements","nodes","find","style","boxSelectionEnabled","autoungrabify","permission","ENTITY_PERMISSIONS","OWNER","autounselectify","enable","unselect","on","_onDblClick","snap","stop","sourceNode","targetNode","addedEles","disable","complete","saveDataToJournal","cxtMenues","cxtMenuCommands","menu","cxtmenu","_onDragOver","_onDragEnter","_onDropEntity","modifyLabel","fillColor","content","contentStyle","select","ele","_modifyData","enabled","node","removeElement","toggleClass","start","addNode","renderedPosition","addEdge","id","entity","_showEntity","uuid","selector","commands","fromUuid","activate","_toggleEdgeDirection","animate","nodeDimensionsIncludeLabels","animationEasing","animationDuration","directed","quality","randomize","Actor","Item","Scene","RollTable","Macro","position","run","nodeData","_getClassByEntityName","thumb","img","add","sourceId","targetId","edgeData","source","element","JSON","parse","dataTransfer","pack","join","actorId","_id","ui","notifications","mousePos","x","offsetX","y","offsetY","timeStamp","radius","renderedWidth","pos","el","nodePos","dist","Math","abs","edges","one","setFlag","time","entityClass","NONE","sheet","edge","hasClass","duplicate","addClass","extension","dagre","klay","cola","fcose","cise","spread","loadLayout","resize","dataName","input","focusoutCounter","newData","blur","focus","click","preloadTemplates","templatePaths","loadTemplates","MODULE_NAME","registerSettings"],"mappings":"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","file":"foundryvtt-mindmap.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n \t\tvar prefetchChunks = data[3] || [];\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n \t\t// chunk prefetching for javascript\n \t\tprefetchChunks.forEach(function(chunkId) {\n \t\t\tif(installedChunks[chunkId] === undefined) {\n \t\t\t\tinstalledChunks[chunkId] = null;\n \t\t\t\tvar link = document.createElement('link');\n\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tlink.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tlink.rel = \"prefetch\";\n \t\t\t\tlink.as = \"script\";\n \t\t\t\tlink.href = jsonpScriptSrc(chunkId);\n \t\t\t\tdocument.head.appendChild(link);\n \t\t\t}\n \t\t});\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"index\": 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"bundles/\" + ({\"vendors~cise\":\"vendors~cise\",\"vendors~cola\":\"vendors~cola\",\"vendors~compound-drag-and-drop\":\"vendors~compound-drag-and-drop\",\"vendors~cxtmenu\":\"vendors~cxtmenu\",\"vendors~cytoscape~spread\":\"vendors~cytoscape~spread\",\"vendors~cytoscape\":\"vendors~cytoscape\",\"vendors~spread\":\"vendors~spread\",\"vendors~dagre\":\"vendors~dagre\",\"vendors~edgehandles\":\"vendors~edgehandles\",\"vendors~fcose\":\"vendors~fcose\",\"vendors~klay\":\"vendors~klay\"}[chunkId]||chunkId) + \".bundle.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"modules/foundryvtt-mindmap/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \tvar startupResult = (function() {\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./dist/foundryvtt-mindmap.js\");\n \t})();\n\n \twebpackJsonpCallback([[], {}, 0, [\"vendors~cytoscape~spread\",\"vendors~cytoscape\",\"vendors~spread\",\"vendors~cise\",\"vendors~cola\",\"vendors~compound-drag-and-drop\",\"vendors~cxtmenu\",\"vendors~dagre\",\"vendors~edgehandles\",\"vendors~fcose\",\"vendors~klay\"]]);\n \treturn startupResult;\n","// Import TypeScript modules\nimport { registerSettings } from \"./module/settings.js\";\nimport { preloadTemplates } from \"./module/preloadTemplates.js\";\nimport { MODULE_NAME } from \"./module/settings.js\";\nimport { initHooks, readyHooks } from \"./module/Hooks.js\";\nimport { GraphJournalSheet } from \"./module/graph-journal-sheet.js\";\nexport let debugEnabled = 0;\n// 0 = none, warnings = 1, debug = 2, all = 3\nexport let debug = (...args) => { if (debugEnabled > 1)\n    console.log(`DEBUG:${MODULE_NAME} | `, ...args); };\nexport let log = (...args) => console.log(`${MODULE_NAME} | `, ...args);\nexport let warn = (...args) => { if (debugEnabled > 0)\n    console.warn(`${MODULE_NAME} | `, ...args); };\nexport let error = (...args) => console.error(`${MODULE_NAME} | `, ...args);\nexport let timelog = (...args) => warn(`${MODULE_NAME} | `, Date.now(), ...args);\nexport let i18n = key => {\n    return game.i18n.localize(key);\n};\nexport let i18nFormat = (key, data = {}) => {\n    return game.i18n.format(key, data);\n};\nexport let setDebugLevel = (debugText) => {\n    debugEnabled = { \"none\": 0, \"warn\": 1, \"debug\": 2, \"all\": 3 }[debugText] || 0;\n    // 0 = none, warnings = 1, debug = 2, all = 3\n    if (debugEnabled >= 3)\n        CONFIG.debug.hooks = true;\n};\n/* ------------------------------------ */\n/* Initialize module\t\t\t\t\t*/\n/* ------------------------------------ */\nHooks.once('init', async () => {\n    console.log(`${MODULE_NAME} | Initializing ${MODULE_NAME}`);\n    initHooks();\n    // Assign custom classes and constants here\n    // Register custom module settings\n    registerSettings();\n    //fetchParams();\n    // Preload Handlebars templates\n    await preloadTemplates();\n    // Register custom sheets (if any)\n    //CONFIG.JournalEntry.sheetClass = GraphJournalSheet;\n    // Creating the structure in CONFIG for Journals to have different sheets\n    console.log(\"CustomJournals | Creating the structure to allow multiple Journal Sheets.\");\n    CONFIG[\"JournalEntry\"][\"sheetClasses\"] = {};\n    CONFIG[\"JournalEntry\"][\"sheetClasses\"][CONST.BASE_ENTITY_TYPE] = {};\n    console.log(`${MODULE_NAME} | Registering the module's sheets.`);\n    /*CUSTOMIZE\n    * Here, register your sheet so it shows up properly in the dropdown, just change\n    * for your sheet name and you're good to go\n    */\n    // The default Foundry journal\n    //@ts-ignore\n    EntitySheetConfig.registerSheet(JournalEntry, \"journals\", GraphJournalSheet, {\n        // label: game.i18n.localize(\"custom-Journal.CustomJournalSheet\"),\n        types: [CONST.BASE_ENTITY_TYPE],\n        makeDefault: false\n    });\n});\n/* ------------------------------------ */\n/* Setup module\t\t\t\t\t\t\t*/\n/* ------------------------------------ */\nHooks.once('setup', function () {\n    // Do anything after initialization but before ready\n    // setupModules();\n    registerSettings();\n    // fromUuid('JournalEntry.uRAS8eO7VOolui9w').then(journal => journal.show(\"graph\", true))\n    // Only show welcome screen to gms\n    // if (!game.user.isGM){\n    //   return;\n    // }\n    // Edit next line to match module.\n    // const module = game.modules.get(MODULE_NAME);\n    // const moduleId = module.id;\n    // const title = module.data.title;\n    // const moduleVersion = module.data.version;\n    // game.settings.register(title, 'version', {\n    //   name: `${title} Version`,\n    //   default: \"0.0.0\",\n    //   type: String,\n    //   scope: 'world',\n    // });\n    // const oldVersion = game.settings.get(title, \"version\");\n    // if (!isNewerVersion(moduleVersion, oldVersion))\n    //   return;\n    // class WelcomeScreen extends Application {\n    //   static get defaultOptions() {\n    //     const options = super.defaultOptions;\n    //     options.template = `modules/${moduleId}/templates/welcome-screen.html`;\n    //     options.resizable = true;\n    //     options.width = 450;\n    //     options.height = 600;\n    //     options.classes = [\"welcome-screen\"];\n    //     options.title = `${title} - Welcome Screen`;\n    //     return options;\n    //   }\n    //   activateListeners(html) {\n    //     super.activateListeners(html);\n    //     html.find('.show-again').on('change', ev => {\n    //       let val = \"0.0.0\";\n    //       if (ev.currentTarget.checked)\n    //         val = moduleVersion;\n    //       game.settings.set(title, \"version\", val);\n    //     })\n    //   }\n    // }\n    // (new WelcomeScreen()).render(true);\n});\n/* ------------------------------------ */\n/* When ready\t\t\t\t\t\t\t*/\n/* ------------------------------------ */\nHooks.once('ready', function () {\n    // // Do anything once the module is ready\n    // if (!game.modules.get(\"lib-wrapper\")?.active && game.user.isGM){\n    //  \tui.notifications.error(\"The \" + MODULE_NAME + \" module requires to install and activate the 'libWrapper' module.\");\n    // \treturn;\n    // }\n    readyHooks();\n});\n// Add any additional hooks if necessary\n","import { warn } from \"../foundryvtt-mindmap.js\";\nexport let readyHooks = async () => {\n};\nexport let initHooks = () => {\n    warn(\"Init Hooks processing\");\n    // setup all the hooks\n};\n","import { debug } from \"../foundryvtt-mindmap.js\";\nimport { Graph } from \"./graph.js\";\nimport { MODULE_NAME } from \"./settings.js\";\n//@ts-ignore\nexport class GraphJournalSheet extends JournalSheet {\n    get template() {\n        if (this._sheetMode.toString() === \"graph\") {\n            return `/modules/${MODULE_NAME}/templates/graph-journal-sheet.html`; //\"/modules/mindmap/templates/graph-journal-sheet.html\";\n        }\n        return super.template;\n    }\n    // static get name() {\n    // \treturn 'JournalSheet';\n    // }\n    get journal() {\n        return this.object;\n    }\n    get name() {\n        return 'GraphJournalSheet';\n    }\n    get title() {\n        return 'GraphJournalSheet';\n    }\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n        options.baseApplication = \"JournalSheet\";\n        options.classes.push('graph-journal');\n        return options;\n    }\n    //Include the option for the Drop Cap style in the editor styles' menu\n    activateEditor(name, options = {}, ...args) {\n        //@ts-ignore\n        options.style_formats.push({\n            title: 'GraphJournalSheet Selection',\n            items: [\n                {\n                    title: 'GraphJournalSheet',\n                    inline: 'span',\n                    classes: 'drop-cap',\n                    wrapper: false\n                }\n            ]\n        });\n        //@ts-ignore\n        super.activateEditor(name, options, ...args);\n    }\n    /**\n     * @override\n     */\n    _getHeaderButtons() {\n        const isOwner = this.object.owner, atLeastLimited = this.object.hasPerm(game.user, \"LIMITED\"), hasMindMap = !!this.object.getFlag(MODULE_NAME, 'data'), hasMultipleModes = this.object.data['img'] && this.object.data['content'];\n        // Set the empty element to some placeholder so the super functions adds the extra buttons\n        const placeholder = \"!!||!!\";\n        if (hasMindMap && !hasMultipleModes) {\n            if (!this.object.data['img']) {\n                this.object.data['img'] = placeholder;\n            }\n            else {\n                this.object.data['content'] = placeholder;\n            }\n        }\n        let buttons = super._getHeaderButtons();\n        if (isOwner || (atLeastLimited && hasMindMap)) {\n            buttons.splice(1, 0, {\n                label: \"MindMap\",\n                class: \"entry-graph\",\n                icon: \"fas fa-project-diagram\",\n                //@ts-ignore\n                onclick: (ev) => this._onSwapMode(ev, \"graph\")\n            });\n        }\n        // Remove the placeholder\n        // And remove the button that is wrongly added\n        if (hasMindMap && !hasMultipleModes)\n            if (this.object.data['img'] === placeholder) {\n                this.object.data['img'] = \"\";\n                const idx = buttons.findIndex(e => e.label === \"Image\");\n                buttons.splice(idx, 1);\n            }\n            else {\n                this.object.data['content'] = \"\";\n                const idx = buttons.findIndex(e => e.label === \"Text\");\n                buttons.splice(idx, 1);\n            }\n        return buttons;\n    }\n    //@ts-ignore\n    _inferDefaultMode() {\n        const hasImage = !!this.object.data['img'];\n        const hasMindmapElements = !!this.object.getFlag(MODULE_NAME, 'data.elements');\n        const otherwise = this.object.limited ? null : this.object.data['content'] ? \"text\" : hasMindmapElements ? \"graph\" : \"text\";\n        return hasImage ? \"image\" : otherwise;\n    }\n    activateListeners(html) {\n        super.activateListeners(html);\n        if (this._sheetMode.toString() !== \"graph\") {\n            return;\n        }\n        const graphContainer = html[0].querySelector('.graph');\n        if (this['_graph']) {\n            this['_graph'].destroy();\n        }\n        this['_graph'] = new Graph(graphContainer, this.object);\n        const settings = html[0].querySelector('.graph-settings-menu');\n        settings.addEventListener('click', ev => {\n            ev.preventDefault();\n            ev.stopPropagation();\n            ev.currentTarget.closest('.graph-settings').classList.remove('open');\n            ev.currentTarget.closest('.graph-settings').querySelector('.graph-layout-chooser').classList.remove('open');\n            return false;\n        });\n        settings.addEventListener('mousedown', ev => {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return false;\n        });\n        settings.addEventListener('mouseup', ev => {\n            ev.preventDefault();\n            ev.stopPropagation();\n            return false;\n        });\n        html[0].querySelector('.graph-settings-btn').addEventListener('click', ev => {\n            ev.preventDefault();\n            ev.stopPropagation();\n            ev.currentTarget.closest('.graph-settings').classList.toggle('open');\n            return false;\n        });\n        settings.querySelector('.graph-fit-btn').addEventListener('click', ev => this['_graph'].fit());\n        settings.querySelector('.graph-clear-btn').addEventListener('click', ev => this['_graph'].removeSelected());\n        settings.querySelector('.graph-layout-btn').addEventListener('click', ev => {\n            ev.preventDefault();\n            ev.stopPropagation();\n            ev.currentTarget.parentNode.querySelector('.graph-layout-chooser').classList.toggle('show');\n            return false;\n        });\n        settings.querySelector('.graph-layout-chooser').addEventListener('click', ev => {\n            ev.preventDefault();\n            ev.stopPropagation();\n            this['_graph'].layout = (ev.target.name);\n        });\n        html[0].addEventListener('click', ev => ev.currentTarget.querySelector('.graph-settings').classList.remove('open'));\n    }\n    getData() {\n        const data = super.getData();\n        data['layouts'] = Graph.layouts;\n        return data;\n    }\n    // async _render(force, options={}) {\n    // \tconsole.log(force, options={});\n    // \treturn super._render(force, options);\n    // }\n    /**\n     * Only rerender if graph is not active, else just update graph.\n     * For smoother graph transitions.\n     * @param {*} force\n     * @param {*} options\n     */\n    render(force = false, options = {}) {\n        debug('rendering sheet', options);\n        if (this.rendered && (!options['sheetMode'] || options['sheetMode'] === \"graph\") && this._sheetMode.toString() === \"graph\") {\n            const udata = getProperty(options, \"data.flags.\" + MODULE_NAME + \".data\");\n            if (udata) {\n                this['_graph'].update(udata);\n            }\n            return this;\n        }\n        if (this['_graph'] && this['_graph']._cy) {\n            this['_graph']._cy.destroy();\n        }\n        return super.render(force, options);\n    }\n    async _render(...args) {\n        await super._render(...args);\n    }\n    _injectHTML(html, options) {\n        $('body').append(html);\n        this._element = html;\n        html.hide().fadeIn(200, ev => {\n            if (this['_graph']) {\n                this['_graph'].init();\n            }\n        });\n    }\n    setPosition(...args) {\n        const [left, top, width, height, scale] = args;\n        const ret = super.setPosition({ left, top, width, height, scale });\n        if (this['_graph']) {\n            this['_graph'].update();\n        }\n        return ret;\n    }\n}\n","import { debug, log } from \"../foundryvtt-mindmap.js\";\nimport { MODULE_NAME } from \"./settings.js\";\n// // https://github.com/d3/d3\n// // import d3 from './libs/d3/d3.js';\n// import d3 from 'd3';\nlet cytoscape;\nasync function initCytoscape() {\n    cytoscape = await import(\n    /* webpackPrefetch: true */\n    /* webpackChunkName: \"cytoscape\" */\n    'cytoscape');\n    // cytoscape = await import('./libs/cytoscape.js/cytoscape.min.js');\n}\nlet extensionsImported = false;\nasync function importExtensions() {\n    const edgehandles = (await import(\n    /* webpackPrefetch: true */\n    /* webpackChunkName: \"edgehandles\" */\n    'cytoscape-edgehandles')).default;\n    const contextMenus = (await import(\n    /* webpackPrefetch: true */\n    /* webpackChunkName: \"cxtmenu\" */\n    'cytoscape-cxtmenu')).default;\n    const compoundDragAndDrop = (await import(\n    /* webpackPrefetch: true */\n    /* webpackChunkName: \"compound-drag-and-drop\" */\n    'cytoscape-compound-drag-and-drop')).default;\n    cytoscape.use(compoundDragAndDrop);\n    cytoscape.use(edgehandles);\n    cytoscape.use(contextMenus);\n    // const edgehandles = (await import('./libs/cytoscape.js-edgehandles/cytoscape-edgehandles.js'));\n    // const contextMenus = (await import('./libs/cytoscape.js-context-menus/cytoscape-context-menus.js'));\n    // const compoundDragAndDrop = (await import('./libs/cytoscape.js-compound-drag-and-drop/cytoscape-compound-drag-and-drop.js'));\n    // cytoscape.use( compoundDragAndDrop );\n    // cytoscape.use( edgehandles );\n    // cytoscape.use( contextMenus );\n    extensionsImported = true;\n}\n/**\n * Lazy load module by name\n * @param {*} name\n */\nasync function loadLayout(name) {\n    const layouts = (await {\n        dagre: async () => import(\n        /* webpackPrefetch: true */\n        /* webpackChunkName: \"dagre\" */\n        'cytoscape-dagre'),\n        klay: async () => import(\n        /* webpackPrefetch: true */\n        /* webpackChunkName: \"klay\" */\n        'cytoscape-klay'),\n        cola: async () => import(\n        /* webpackPrefetch: true */\n        /* webpackChunkName: \"cola\" */\n        'cytoscape-cola'),\n        fcose: async () => import(\n        /* webpackPrefetch: true */\n        /* webpackChunkName: \"fcose\" */\n        'cytoscape-fcose'),\n        cise: async () => import(\n        /* webpackPrefetch: true */\n        /* webpackChunkName: \"cise\" */\n        'cytoscape-cise'),\n        spread: async () => import(\n        /* webpackPrefetch: true */\n        /* webpackChunkName: \"spread\" */\n        'cytoscape-spread'),\n    }[name]()).default;\n    cytoscape.use(layouts);\n    // cytoscape.use( cise );\n    // cytoscape.use( cola );\n    // cytoscape.use( coseBilkent );\n    // cytoscape.use( cxtmenu );\n    // cytoscape.use( dagre );\n    // cytoscape.use( fcose );\n    // cytoscape.use( klay );\n    // cytoscape.use( spread );\n    // const layouts = (\n    // \tawait {\n    // \t\tdagre: async () => import('./libs/cytoscape.js-dagre/cytoscape-dagre.js'),\n    // \t\tklay: async () => import('./libs/cytoscape.js-klay/cytoscape-klay.js'),\n    // \t\tcola: async () => import('./libs/cytoscape.js-cola/cytoscape-cola.js'),\n    // \t\tfcose: async () => import('./libs/cytoscape.js-fcose/cytoscape-fcose.js'),\n    // \t\tcise: async () => import('./libs/cytoscape.js-cise/cytoscape-cise.js'),\n    // \t\tspread: async () => import('./libs/cytoscape.js-spread/cytoscape-spread.js'),\n    // \t\tcxtmenu: async () => import('./libs/cytoscape.js-cxtmenu/cytoscape-cxtmenu.js'),\n    // \t\tcoseBilkent: async () => import('./libs/cytoscape.js-cose-bilkent/cytoscape-cose-bilkent.js'),\n    // \t}[name]()).default;\n    // cytoscape.use(layouts);\n}\nconst dblClickTime = 300;\nexport class Graph {\n    constructor(container, journal, options = {}) {\n        this['_style'] = [...this.defaultStyle, ...(options['style'] || [])];\n        this['_layout'] = { ...this.defaultLayout, ...(options['layout'] || {}) };\n        this['_journal'] = journal;\n        this['_container'] = container;\n        this['_selectedNode'] = null;\n        this['_dragTime'] = null;\n    }\n    async init() {\n        if (!cytoscape) {\n            await initCytoscape();\n        }\n        if (!extensionsImported) {\n            await importExtensions();\n        }\n        const journal = this['_journal'];\n        const container = this['_container'];\n        let json = journal.getFlag(MODULE_NAME, 'data') || { elements: {} };\n        if (!json.elements.nodes) {\n            json.elements =\n                [\n                    {\n                        data: {\n                            name: \"Drag Entities onto the Canvas or right click me.\",\n                            type: \"text\"\n                        },\n                        classes: [\n                            'text-node'\n                        ]\n                    }\n                ];\n        }\n        if (json.layout) {\n            let layout = Graph.layouts.find(e => e.name === json.layout.name);\n            this['_layout'] = { ...this.defaultLayout, ...layout };\n        }\n        else\n            this['_layout'] = this.defaultLayout;\n        log('Initializing.. ', json, this);\n        this['_cy'] = cytoscape['default']({\n            container: container,\n            elements: json.elements,\n            layout: { name: \"preset\" },\n            style: this['_style'],\n            boxSelectionEnabled: true,\n            autoungrabify: journal.permission < CONST.ENTITY_PERMISSIONS.OWNER ? true : false,\n            autounselectify: journal.permission < CONST.ENTITY_PERMISSIONS.OWNER ? true : false\n        });\n        window['cy'] = this['_cy'];\n        const cdnd = this['_cy'].compoundDragAndDrop();\n        cdnd.enable();\n        await this.update();\n        this['_cy'].nodes().unselect();\n        // Open Entity with double clicked\n        this['_cy'].on('click', 'node', ev => this._onDblClick(ev));\n        if (journal.permission < CONST.ENTITY_PERMISSIONS.OWNER) {\n            return;\n        }\n        this['_eh'] = this['_cy'].edgehandles({\n            snap: true,\n            stop: (sourceNode, targetNode, addedEles) => {\n                this['_eh'].disable();\n            },\n            complete: (sourceNode, targetNode, addedEles) => {\n                log(sourceNode, targetNode, addedEles, this['_cy'].json().elements);\n                this.saveDataToJournal();\n            }\n        });\n        this['_eh'].hide();\n        this['_eh'].disable();\n        const cxtMenues = this.cxtMenuCommands;\n        for (let menu of cxtMenues) {\n            this['_cy'].cxtmenu(menu);\n        }\n        // Save after finishing dragging a node, but only if layout is preset\n        this['_cy'].on('free', 'node', ev => { this.saveDataToJournal(); });\n        container.addEventListener('dragover', ev => this._onDragOver(ev));\n        container.addEventListener('dragenter', ev => this._onDragEnter(ev));\n        container.addEventListener('drop', ev => this._onDropEntity(ev));\n    }\n    get cxtMenuCommands() {\n        let ret = [];\n        const modifyLabel = {\n            fillColor: 'RGBA(50, 50, 50, 0.75)',\n            content: '<i class=\"fas fa-tag\"></i><br>Modify label',\n            contentStyle: {},\n            select: (ele) => this._modifyData(ele, 'name', 'text'),\n            enabled: true\n        };\n        let node = [\n            {\n                fillColor: 'RGBA(200, 50, 50, 0.75)',\n                content: '<i class=\"fa fa-trash\" aria-hidden=\"true\"></i><br>Remove<br>Node',\n                select: (ele) => this.removeElement(ele),\n                enabled: true\n            },\n            {\n                fillColor: 'RGBA(50, 50, 50, 0.75)',\n                content: 'Toggle visited',\n                select: (ele) => {\n                    ele.toggleClass('visited');\n                    this.saveDataToJournal();\n                },\n                enabled: true\n            },\n            {\n                fillColor: 'RGBA(50, 50, 50, 0.75)',\n                content: 'Add<br>Edge',\n                select: (ele) => {\n                    this['_eh'].enable();\n                    this['_eh'].start(ele);\n                },\n                enabled: true\n            },\n            {\n                fillColor: 'RGBA(50, 50, 50, 0.75)',\n                content: 'Add<br>Textnode',\n                select: async (ele) => {\n                    const node = await this.addNode(null, ele.renderedPosition());\n                    this.addEdge(ele.data().id, node.data().id, true);\n                },\n                enabled: true\n            },\n            modifyLabel,\n        ];\n        let entity = [\n            ...node,\n            ...[\n                {\n                    fillColor: 'RGBA(50, 50, 50, 0.75)',\n                    content: '<i class=\"fas fa-eye\"></i><br>Open Sheet',\n                    select: (ele) => this._showEntity(ele.data().uuid),\n                    enabled: true\n                },\n            ]\n        ];\n        ret.push({\n            selector: '.scene',\n            commands: [\n                ...node,\n                ...[\n                    {\n                        fillColor: 'RGBA(50, 50, 50, 0.75)',\n                        content: '<i class=\"fas fa-bullseye fa-fw\"></i><br>Activate',\n                        select: async (ele) => {\n                            const entity = await fromUuid(ele.data().uuid);\n                            //@ts-ignore\n                            entity.activate();\n                        },\n                        enabled: true\n                    },\n                ]\n            ]\n        });\n        ret.push({\n            selector: '.journal-entry',\n            commands: [\n                ...entity\n            ]\n        });\n        ret.push({\n            selector: '.actor',\n            commands: [\n                ...entity\n            ]\n        });\n        ret.push({\n            selector: '.rollable-tables',\n            commands: [\n                ...entity\n            ]\n        });\n        ret.push({\n            selector: '.item',\n            commands: [\n                ...entity\n            ]\n        });\n        ret.push({\n            selector: '.macro',\n            commands: [\n                ...entity\n            ]\n        });\n        ret.push({\n            selector: '.text-node',\n            commands: [\n                ...node,\n            ]\n        });\n        ret.push({\n            selector: 'node:compound',\n            commands: [\n                ...node,\n            ]\n        });\n        // Edge\n        ret.push({\n            selector: 'edge',\n            commands: [\n                {\n                    fillColor: 'RGBA(200, 50, 50, 0.75)',\n                    content: '<i class=\"fa fa-trash\" aria-hidden=\"true\"></i><br>Remove<br>Edge',\n                    select: (ele) => this.removeElement(ele),\n                    enabled: true\n                },\n                {\n                    fillColor: 'RGBA(50, 50, 50, 0.75)',\n                    content: '<i class=\"fas fa-map-signs\"></i><br>Toggle direction',\n                    contentStyle: {},\n                    select: (ele) => this._toggleEdgeDirection(ele),\n                    enabled: true\n                },\n                modifyLabel,\n                {\n                    fillColor: 'RGBA(50, 50, 50, 0.75)',\n                    content: '<i class=\"fas fa-palette\"></i><br>Change Color',\n                    contentStyle: {},\n                    select: (ele) => this._modifyData(ele, 'color', 'color'),\n                    enabled: true\n                }\n            ]\n        });\n        return ret;\n    }\n    get defaultStyle() {\n        return [\n            {\n                selector: 'node',\n                style: {\n                    'background-fit': 'cover',\n                    'background-color': '#666',\n                    'text-valign': 'bottom',\n                    'border-width': 1,\n                    'border-style': 'solid',\n                    'border-color': '#666',\n                    'border-opacity': 0.8,\n                    'font-family': 'Signika, sans-serif',\n                    'font-size': 9,\n                    'text-wrap': 'wrap',\n                    'text-max-width': '100px',\n                    'color': '#333',\n                    'width': 30,\n                    'height': 30\n                }\n            },\n            {\n                selector: 'node[name]',\n                style: {\n                    'label': 'data(name)',\n                }\n            },\n            {\n                selector: 'node:compound',\n                style: {\n                    'background-color': '#999',\n                    'background-opacity': '0.5',\n                }\n            },\n            {\n                selector: '.visited',\n                style: {\n                    'opacity': 0.55,\n                    'border-color': '#A00',\n                    'border-width': 2,\n                    'background-blacken': 0.3\n                }\n            },\n            {\n                selector: 'edge',\n                style: {\n                    'curve-style': 'bezier',\n                    'width': \"2px\",\n                    'line-color': \"#999\",\n                    'target-arrow-color': '#999',\n                    'target-arrow-shape': 'triangle-backcurve',\n                    'arrow-scale': 1.5,\n                    'source-endpoint': 'outside-to-node-or-label',\n                    'target-endpoint': 'outside-to-node-or-label',\n                }\n            },\n            {\n                selector: '.undirected',\n                style: {\n                    'target-arrow-shape': 'none'\n                }\n            },\n            {\n                selector: 'edge[name]',\n                style: {\n                    'font-family': 'Signika, sans-serif',\n                    'label': 'data(name)',\n                    'text-rotation': 'autorotate',\n                    'color': '#333',\n                    'font-size': 9,\n                    'text-wrap': 'wrap',\n                    'text-max-width': '40px',\n                    'text-outline-color': '#ccc',\n                    'text-outline-width': 1,\n                    'text-outline-opacity': 0.5\n                }\n            },\n            {\n                selector: 'edge[color]',\n                style: {\n                    'line-color': 'data(color)',\n                    'target-arrow-color': 'data(color)',\n                }\n            },\n            {\n                selector: '.journal-entry',\n                style: {\n                    'background-image': `/modules/${MODULE_NAME}/assets/open-book.png` //'modules/mindmap/assets/open-book.png'\n                },\n            },\n            {\n                selector: '.actor',\n                style: {\n                    'background-image': `/modules/${MODULE_NAME}/assets/assets/person.png` //'modules/mindmap/assets/person.png'\n                },\n            },\n            {\n                selector: '.item',\n                style: {\n                    'background-image': `/modules/${MODULE_NAME}/assets/assets/suitcase.png` //'modules/mindmap/assets/suitcase.png'\n                },\n            },\n            {\n                selector: '.roll-table',\n                style: {\n                    'background-image': `/modules/${MODULE_NAME}/assets/assets/rolling-dices.png` //'modules/mindmap/assets/rolling-dices.png'\n                }\n            },\n            {\n                selector: '.macro',\n                style: {\n                    'background-image': 'icons/svg/dice-target.svg'\n                }\n            },\n            {\n                selector: '.img',\n                style: {\n                    'background-image': 'data(img)'\n                }\n            },\n            {\n                selector: 'node:selected',\n                style: {\n                    'border-style': 'dashed',\n                    'border-width': '2px',\n                    'border-color': '#0169d9',\n                    'border-opacity': 1,\n                    'background-blacken': -0.3\n                }\n            },\n            {\n                selector: '.text-node',\n                style: {\n                    'shape': 'star',\n                    'width': 15,\n                    'height': 15,\n                    'font-size': 9,\n                }\n            }\n        ];\n    }\n    get defaultLayout() {\n        return {\n            name: 'dagre',\n            animate: true,\n            fit: true,\n            nodeDimensionsIncludeLabels: true,\n            animationEasing: 'ease-out-sine',\n            animationDuration: 300\n        };\n    }\n    static get layouts() {\n        return [\n            { name: 'preset', label: 'Manual', fit: false },\n            { name: 'grid', label: 'Grid' },\n            { name: 'circle', label: 'Circle' },\n            { name: 'concentric', label: 'Concentric Circles' },\n            { name: 'breadthfirst', label: 'Breadthfirst (Tree like)', directed: true },\n            { name: 'dagre', label: 'Dagre' },\n            { name: 'klay', label: 'Klay' },\n            { name: 'fcose', label: 'fast Compound Spring Embedder', quality: \"proof\", randomize: false },\n            // { name: 'cose-bilkent', label: '' },\n            { name: 'spread', label: 'Spread' },\n            { name: 'cise', label: 'Circular Spring Embedder', animate: false },\n            { name: 'cola', label: 'Cola' },\n            { name: 'random', label: 'Random' },\n        ];\n    }\n    set layout(name) {\n        const layout = Graph.layouts.find(e => e.name === name);\n        if (!layout)\n            throw new Error('Graphs | Layout not found!');\n        this['_layout'] = { ...this.defaultLayout, ...layout };\n        this.saveDataToJournal();\n    }\n    _getClassByEntityName(name) {\n        return {\n            JournalEntry: 'journal-entry',\n            Actor: 'actor',\n            Item: 'item',\n            Scene: 'scene',\n            RollTable: 'roll-table',\n            Macro: 'macro'\n        }[name];\n    }\n    async addNode(entity, position, run = false) {\n        let nodeData;\n        if (entity) {\n            nodeData = {\n                data: {\n                    // id: entity.id || entity._id,\n                    name: entity.name,\n                    type: entity.entity,\n                    uuid: entity.uuid\n                },\n                classes: [\n                    this._getClassByEntityName(entity.entity),\n                    'entity'\n                ]\n            };\n            if (entity.data.thumb) {\n                nodeData.data.img = entity.data.thumb;\n                nodeData.classes.push('img');\n            }\n            else if (entity.img || entity.data.img) {\n                nodeData.data.img = entity.img || entity.data.img;\n                nodeData.classes.push('img');\n            }\n        }\n        else { // Textnode\n            nodeData = {\n                data: {\n                    name: \"New Textnode\",\n                    type: \"text\"\n                },\n                classes: [\n                    'text-node'\n                ]\n            };\n        }\n        if (position) {\n            nodeData.renderedPosition = position;\n        }\n        const node = this['_cy'].add(nodeData);\n        if (run)\n            this.saveDataToJournal();\n        return node;\n    }\n    async addEdge(sourceId, targetId, run = false) {\n        let edgeData = {\n            data: {\n                source: sourceId,\n                target: targetId,\n            }\n        };\n        const edge = this['_cy'].add(edgeData);\n        if (run) {\n            this.saveDataToJournal();\n        }\n    }\n    async removeElement(element) {\n        element.remove();\n        this.saveDataToJournal();\n    }\n    async _onDropEntity(ev) {\n        ev.preventDefault();\n        // Try to extract the data\n        let data;\n        try {\n            data = JSON.parse(ev.dataTransfer.getData('text/plain'));\n        }\n        catch (err) {\n            return false;\n        }\n        if (!this._getClassByEntityName(data.type))\n            return false;\n        let entity;\n        try {\n            if (data.pack)\n                entity = await fromUuid(['Compendium', data.pack, data.id].join(\".\"));\n            else if (data.actorId) {\n                const uuid = ['Actor', data.actorId, 'OwnedItem', data.data._id].join(\".\");\n                entity = await fromUuid(uuid);\n                entity.uuid = uuid;\n                entity.id = entity._id;\n                entity.entity = 'Item';\n            }\n            else\n                entity = await fromUuid([data.type, data.id].join(\".\"));\n        }\n        catch (error) {\n            console.error(error);\n            ui.notifications.error('Unsupported entity type');\n            return;\n        }\n        const mousePos = { x: ev.offsetX, y: ev.offsetY };\n        const closest = this['_selectedNode'];\n        let node;\n        try {\n            node = await this.addNode(entity, mousePos, closest ? false : true);\n        }\n        catch (err) {\n            console.error(err);\n            ui.notifications.error('Only one node of that UUID is allowed.');\n            return false;\n        }\n        if (closest) {\n            this.addEdge(closest.data().id, node.data().id, true);\n        }\n        if (this['_selectedNode']) {\n            this['_selectedNode'].unselect();\n            this['_selectedNode'] = null;\n        }\n        return;\n    }\n    async _onDragOver(ev) {\n        if ((ev.timeStamp - this['_dragTime']) < 50) {\n            return;\n        }\n        this['_dragTime'] = ev.timeStamp;\n        const nodes = this['_cy'].nodes();\n        if (nodes.length === 0)\n            return;\n        let radius = nodes[0].renderedWidth();\n        const pos = { x: ev.offsetX, y: ev.offsetY };\n        if (this['_selectedNode']) {\n            this['_selectedNode'].unselect();\n        }\n        this['_selectedNode'] = null;\n        nodes.forEach(el => {\n            let nodePos = el.renderedPosition();\n            let dist = Math.abs(nodePos.x - pos.x) + Math.abs(nodePos.y - pos.y);\n            if (dist < radius) {\n                dist = radius;\n                this['_selectedNode'] = el;\n            }\n            ;\n        });\n        if (this['_selectedNode']) {\n            this['_selectedNode'].select();\n        }\n    }\n    async _onDragEnter(ev) {\n        this['_cy'].nodes().unselect();\n    }\n    async saveDataToJournal() {\n        debug('Saving Data...');\n        // this._cy.one('layoutstop', ev => this._cy.animation({\n        // \t\tcomplete: this._journal.setFlag(MODULE_NAME, 'data', this._cy.json()),\n        // \t\tfit: this._cy,\n        // \t\tduration: 300\n        // \t}).play()\n        // );\n        // this._cy.one('layoutstop', ev => this._journal.setFlag(MODULE_NAME, 'data', this._cy.json()));\n        this['_cy'].nodes('.eh-ghost').remove();\n        // Make sure \"edges\"  gets deleted!\n        let elements = this['_cy'].json().elements;\n        if (!elements.edges || elements.edges.length === 0) {\n            elements[\"-=edges\"] = null;\n        }\n        if (!elements.nodes || elements.nodes.length === 0) {\n            elements[\"-=nodes\"] = null;\n        }\n        let udata = {\n            elements,\n            layout: this['_layout']\n        };\n        // Save data after layout has stopped, to reduce differencees after reopening the journal\n        this['_cy'].one('layoutstop', ev => {\n            let elements = this['_cy'].json().elements;\n            if (!elements.edges || elements.edges.length === 0) {\n                elements[\"-=edges\"] = null;\n            }\n            if (!elements.nodes || elements.nodes.length === 0) {\n                elements[\"-=nodes\"] = null;\n            }\n            let udata = {\n                elements,\n                layout: this['_layout']\n            };\n            this['_journal'].setFlag(MODULE_NAME, 'data', udata);\n        });\n        this.update(udata);\n    }\n    /**\n     * Checks if double left click, if yes, show the entities sheet.\n     * @param {Event} ev\n     */\n    _onDblClick(ev) {\n        this['_rightClicked'] = null;\n        if (this['_clicked']\n            && Math.abs(this['_clicked'].time - ev.timeStamp) < dblClickTime\n            && (this['_clicked'].target === ev.target.data().id)) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            if (ev.target.data('uuid')) {\n                this._showEntity(ev.target.data().uuid);\n            }\n            this['_clicked'] = null;\n        }\n        else {\n            this['_clicked'] = {\n                time: ev.timeStamp,\n                target: ev.target.data().id\n            };\n        }\n    }\n    /**\n     * Show entity sheet to a given uuid.\n     * @param {string} uuid\n     */\n    async _showEntity(uuid) {\n        let entity = await fromUuid(uuid);\n        // owned item\n        //@ts-ignore\n        if (!entity.entity) {\n            entity = new CONFIG.Item.entityClass(entity, null);\n        }\n        //@ts-ignore\n        if (entity.permission > CONST.ENTITY_PERMISSIONS.NONE) {\n            //@ts-ignore\n            entity.sheet.render(true);\n        }\n    }\n    /**\n     * Toggles direction of an edge.\n     * directed -> undirected -> turned around -> undirecter -> directed\n     * @param {Edge} edge\n     */\n    async _toggleEdgeDirection(edge) {\n        if (edge.hasClass('undirected')) {\n            // edge.removeClass('undirected');\n            const data = duplicate(edge.data());\n            const source = data.source;\n            const target = data.target;\n            data.source = target;\n            data.target = source;\n            edge.remove();\n            delete (data.id);\n            this['_cy'].add({ data });\n        }\n        else {\n            edge.addClass('undirected');\n        }\n        this.saveDataToJournal();\n    }\n    /**\n     * Updates the graph with given json data.\n     * @param {Object} udata\n     */\n    async update(udata = {}) {\n        if (!this['_cy']) {\n            return;\n        }\n        //@ts-ignore\n        if (udata.elements) {\n            //@ts-ignore\n            const elements = udata.elements;\n            this['_cy'].json({ elements });\n        }\n        //@ts-ignore\n        if (udata.layout) {\n            //@ts-ignore\n            this['_layout'] = { ...this.defaultLayout, ...udata.layout };\n        }\n        // Load layout if not already done\n        if (!this['_cy'].extension('layout', this['_layout'].name)) {\n            await loadLayout(this['_layout'].name);\n        }\n        this['_cy'].layout(this['_layout']).run();\n        this['_cy'].resize();\n        this['_cy'].fit();\n    }\n    async _modifyData(ele, dataName, type) {\n        let input = document.createElement('input');\n        const data = ele.data(dataName) || \"\";\n        input.value = data;\n        input.type = type;\n        input.style.position = 'absolute';\n        input.style.left = '-500px';\n        input.style.top = '-100px';\n        input.style.width = '300px';\n        // due to the color picker getting opened the color input gets a focusout event on clicking the input.. so only trigger it on the second time!\n        let focusoutCounter = type === 'color' ? 2 : 1;\n        // input.style.zIndex = -1;\n        input.addEventListener('focusout', ev => {\n            const newData = input.value;\n            if (newData !== data) {\n                ele.data(dataName, newData);\n                this.saveDataToJournal();\n            }\n            focusoutCounter--;\n            if (input && !focusoutCounter)\n                input.remove();\n        });\n        input.addEventListener('input', ev => {\n            const newData = input.value;\n            ele.data(dataName, newData);\n        });\n        input.addEventListener('keyup', ev => {\n            if (ev.key !== 'Escape' && ev.key !== 'Enter')\n                return;\n            ev.preventDefault();\n            ev.stopPropagation();\n            if (ev.key === 'Escape') {\n                //@ts-ignore\n                input.value = name;\n            }\n            //@ts-ignore\n            ev.currentTarget.blur();\n        });\n        // input.style.display = 'none';\n        await this['_container'].appendChild(input);\n        input.focus();\n        input.click();\n        window['input'] = input;\n    }\n    fit() {\n        this['_cy'].fit();\n        this['_cy'].resize();\n    }\n    removeSelected() {\n        this['_cy'].nodes(':selected').remove();\n        this.saveDataToJournal();\n    }\n    destroy() {\n        if (this['_cy'])\n            this['_cy'].destroy();\n    }\n}\n","import { MODULE_NAME } from \"./settings.js\";\nexport const preloadTemplates = async function () {\n    const templatePaths = [\n        // Add paths to \"module/XXX/templates\"\n        //`/modules/${MODULE_NAME}/templates/XXX.html`,\n        `/modules/${MODULE_NAME}/templates/graph-journal-sheet.html`\n    ];\n    return loadTemplates(templatePaths);\n};\n","export const MODULE_NAME = 'foundryvtt-mindmap';\nexport const registerSettings = function () {\n};\n// function setup(templateSettings) {\n// \ttemplateSettings.settings().forEach(setting => {\n// \t\tlet options = {\n// \t\t\tname: i18n(templateSettings.name()+\".\"+setting.name+'.Name'),\n// \t\t\thint: i18n(`${templateSettings.name()}.${setting.name}.Hint`),\n// \t\t\tscope: setting.scope,\n// \t\t\tconfig: true,\n// \t\t\tdefault: setting.default,\n// \t\t\ttype: setting.type,\n// \t\t\tchoices: {}\n// \t\t};\n// \t\tif (setting.choices) options.choices = setting.choices;\n// \t\tgame.settings.register(templateSettings.name(), setting.name, options);\n// \t});\n// }\n"],"sourceRoot":""}